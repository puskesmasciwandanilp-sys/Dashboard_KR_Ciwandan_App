<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#0f172a">
  <title>Offline - PKM Ciwandan</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --accent-blue: #3b82f6;
    }
    
    @media (prefers-color-scheme: light) {
      :root {
        --bg-primary: #f8fafc;
        --bg-secondary: #e2e8f0;
        --text-primary: #1e293b;
        --text-secondary: #64748b;
      }
    }
    
    html, body {
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      color: var(--text-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .offline-container {
      text-align: center;
      max-width: 400px;
    }
    
    .offline-icon {
      width: 120px;
      height: 120px;
      margin: 0 auto 32px;
      position: relative;
    }
    
    .cloud {
      fill: var(--text-secondary);
      opacity: 0.5;
    }
    
    .lightning {
      fill: #fbbf24;
      animation: flash 2s infinite;
    }
    
    @keyframes flash {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }
    
    .no-wifi {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 50px;
      height: 50px;
      background: #ef4444;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(239, 68, 68, 0.4);
    }
    
    .no-wifi svg {
      width: 28px;
      height: 28px;
      fill: white;
    }
    
    h1 {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 12px;
      background: linear-gradient(135deg, var(--accent-blue), #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .subtitle {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 32px;
      line-height: 1.6;
    }
    
    .tips {
      background: var(--bg-secondary);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 32px;
      text-align: left;
    }
    
    .tips-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .tips-list {
      list-style: none;
    }
    
    .tips-list li {
      font-size: 14px;
      color: var(--text-secondary);
      padding: 8px 0;
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    
    .tips-list li::before {
      content: "âœ“";
      color: var(--accent-blue);
      font-weight: bold;
      flex-shrink: 0;
    }
    
    .retry-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 14px 32px;
      background: linear-gradient(135deg, var(--accent-blue), #6366f1);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 20px rgba(59, 130, 246, 0.3);
    }
    
    .retry-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 30px rgba(59, 130, 246, 0.4);
    }
    
    .retry-btn:active {
      transform: translateY(0);
    }
    
    .retry-btn svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
      animation: none;
    }
    
    .retry-btn:hover svg {
      animation: spin 0.5s ease;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .status {
      margin-top: 24px;
      font-size: 12px;
      color: var(--text-secondary);
    }
    
    .status-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ef4444;
      margin-right: 8px;
      animation: pulse 2s infinite;
    }
    
    .status-dot.online {
      background: #10b981;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(0.9); }
    }
    
    /* Cached Data Section */
    .cached-data {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .cached-title {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }
    
    .cached-info {
      font-size: 12px;
      color: var(--text-secondary);
      opacity: 0.7;
    }
    
    @media (max-width: 480px) {
      h1 {
        font-size: 24px;
      }
      
      .subtitle {
        font-size: 14px;
      }
      
      .tips {
        padding: 16px;
      }
    }
    
    /* Safe area */
    @supports (padding: env(safe-area-inset-bottom)) {
      body {
        padding-bottom: calc(20px + env(safe-area-inset-bottom));
      }
    }
  </style>
</head>
<body>
  <div class="offline-container">
    <div class="offline-icon">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path class="cloud" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96z"/>
        <path class="lightning" d="M11 15h2v2h-2zm0-8h2v6h-2z"/>
      </svg>
      <div class="no-wifi">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M23.64 7c-.45-.34-4.93-4-11.64-4-1.5 0-2.89.19-4.15.48L18.18 13.8 23.64 7zM17.04 15.22L3.27 1.44 2 2.72l2.05 2.06C1.91 5.76.59 6.82.36 7l11.63 14.49.01.01.01-.01 3.9-4.86 3.32 3.32 1.27-1.27-3.46-3.46z"/>
        </svg>
      </div>
    </div>
    
    <h1>Tidak Ada Koneksi</h1>
    <p class="subtitle">
      Sepertinya Anda sedang offline. Periksa koneksi internet Anda dan coba lagi.
    </p>
    
    <div class="tips">
      <div class="tips-title">
        <span>ðŸ’¡</span>
        <span>Tips Mengatasi:</span>
      </div>
      <ul class="tips-list">
        <li>Periksa koneksi WiFi atau data seluler</li>
        <li>Coba matikan mode pesawat jika aktif</li>
        <li>Restart router WiFi jika diperlukan</li>
        <li>Pindah ke area dengan sinyal lebih baik</li>
      </ul>
    </div>
    
    <button class="retry-btn" onclick="retryConnection()">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
      </svg>
      Coba Lagi
    </button>
    
    <div class="status">
      <span class="status-dot" id="statusDot"></span>
      <span id="statusText">Mendeteksi koneksi...</span>
    </div>
    
    <div class="cached-data" id="cachedData" style="display: none;">
      <div class="cached-title">ðŸ“¦ Data Tersimpan</div>
      <div class="cached-info" id="cachedInfo"></div>
    </div>
  </div>
  
  <script>
    // Check connection status
    function updateStatus() {
      const dot = document.getElementById('statusDot');
      const text = document.getElementById('statusText');
      
      if (navigator.onLine) {
        dot.classList.add('online');
        text.textContent = 'Koneksi tersedia - memuat ulang...';
        setTimeout(() => {
          window.location.reload();
        }, 1000);
      } else {
        dot.classList.remove('online');
        text.textContent = 'Tidak ada koneksi internet';
      }
    }
    
    // Retry connection
    function retryConnection() {
      const btn = document.querySelector('.retry-btn');
      btn.innerHTML = '<svg viewBox="0 0 24 24" style="animation: spin 1s linear infinite;"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" fill="currentColor"/></svg> Mencoba...';
      
      setTimeout(() => {
        if (navigator.onLine) {
          window.location.href = './';
        } else {
          btn.innerHTML = '<svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" fill="currentColor"/></svg> Coba Lagi';
          updateStatus();
        }
      }, 1500);
    }
    
    // Check for cached data
    function checkCachedData() {
      if ('caches' in window) {
        caches.keys().then(names => {
          if (names.length > 0) {
            const cachedSection = document.getElementById('cachedData');
            const cachedInfo = document.getElementById('cachedInfo');
            cachedSection.style.display = 'block';
            cachedInfo.textContent = 'Beberapa data dashboard tersimpan di cache untuk akses offline.';
          }
        });
      }
    }
    
    // Event listeners
    window.addEventListener('online', updateStatus);
    window.addEventListener('offline', updateStatus);
    
    // Initialize
    updateStatus();
    checkCachedData();
  </script>
</body>
</html>

